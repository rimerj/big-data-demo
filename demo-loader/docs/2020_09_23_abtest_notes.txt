===============Local Run===============
/mnt/ods/provider_test_2020_09_23/

*** Original dfs
[professional_v6] 2534
[professional_v5] 2534
[facility_v6] 8
[facility_v5] 8


*** Simple dedup dfs
[professional_v6] 2492
[professional_v5] 2511
[facility_v6] 6
[facility_v5] 6

[plbt] 2517

===============Small Run===============
"/mnt/billing/GDP001/runlog/CP10006a/", "/mnt/ods/bdp_2020_09_23_small_abtest_original/"
*** Original dfs
[professional_v6] 586
[professional_v5] 205495
[facility_v6] 60
[facility_v5] 4253


*** Simple dedup dfs
[professional_v6] 218
[professional_v5] 21946
[facility_v6] 21
[facility_v5] 578

**** versionMergedFacility 
select concat (concat (v5.filename, ' ++ '), v6.filename) as lineage_filename, v5.accreditation_body, v5.accreditation_status, v5.billing_fax, v5.billing_phone, v5.claim_remit_address_line1, v5.claim_remit_address_line2, v5.claim_remit_city, v5.claim_remit_name, v5.claim_remit_state, v5.claim_remit_zip_code, v5.clinical_staff_language_spoken1, v5.clinical_staff_language_spoken2, v5.clinical_staff_language_spoken3, v5.ecp_provider, v5.emr_type, v5.emr_version, v6.end_date, v6.facility_address_line1, v6.facility_address_line2, v6.facility_city, v5.facility_clia, v5.facility_county, case when v6.time_folder > v5.time_folder then v6.facility_fax else v5.facility_fax end as facility_fax, case when v6.time_folder > v5.time_folder then v6.facility_name_dba else v5.facility_name_dba end as facility_name_dba, v6.facility_state, case when v6.time_folder > v5.time_folder then v6.facility_telephone else v5.facility_telephone end as facility_telephone, case when v6.time_folder > v5.time_folder then v6.facility_type else v5.facility_type end as facility_type, v6.facility_zip_code, v5.fee_schedule, case when v6.time_folder > v5.time_folder then v6.filename else v5.filename end as filename, case when v6.time_folder > v5.time_folder then v6.filepath else v5.filepath end as filepath, case when v6.time_folder > v5.time_folder then v6.fk_facility_crosswalk_address else v5.fk_facility_crosswalk_address end as fk_facility_crosswalk_address, case when v6.time_folder > v5.time_folder then v6.fk_facility_golden_address_id else v5.fk_facility_golden_address_id end as fk_facility_golden_address_id, case when v6.time_folder > v5.time_folder then v6.fk_facility_legacy_ulid else v5.fk_facility_legacy_ulid end as fk_facility_legacy_ulid, case when v6.time_folder > v5.time_folder then v6.hc else v5.hc end as hc, v5.hours_of_operation_friday_end_time, v5.hours_of_operation_friday_start_time, v5.hours_of_operation_monday_end_time, v5.hours_of_operation_monday_start_time, v5.hours_of_operation_saturday_end_time, v5.hours_of_operation_saturday_start_time, v5.hours_of_operation_sunday_end_time, v5.hours_of_operation_sunday_start_time, v5.hours_of_operation_thursday_end_time, v5.hours_of_operation_thursday_start_time, v5.hours_of_operation_tuesday_end_time, v5.hours_of_operation_tuesday_start_time, v5.hours_of_operation_wednesday_end_time, v5.hours_of_operation_wednesday_start_time, case when v6.time_folder > v5.time_folder then v6.iops_data_factory_execution_message else v5.iops_data_factory_execution_message end as iops_data_factory_execution_message, case when v6.time_folder > v5.time_folder then v6.iops_data_factory_execution_status else v5.iops_data_factory_execution_status end as iops_data_factory_execution_status, case when v6.time_folder > v5.time_folder then v6.iops_data_factory_pipeline_run_id else v5.iops_data_factory_pipeline_run_id end as iops_data_factory_pipeline_run_id, case when v6.time_folder > v5.time_folder then v6.iops_provider_credentialing_method else v5.iops_provider_credentialing_method end as iops_provider_credentialing_method, case when v6.time_folder > v5.time_folder then v6.iops_request_create_datetime else v5.iops_request_create_datetime end as iops_request_create_datetime, case when v6.time_folder > v5.time_folder then v6.iops_roster_format else v5.iops_roster_format end as iops_roster_format, case when v6.time_folder > v5.time_folder then v6.iops_roster_type else v5.iops_roster_type end as iops_roster_type, case when v6.time_folder > v5.time_folder then v6.iops_trading_partner_id else v5.iops_trading_partner_id end as iops_trading_partner_id, case when v6.time_folder > v5.time_folder then v6.latest_data_rank else v5.latest_data_rank end as latest_data_rank, v5.mailing_address_city, v5.mailing_address_line1, v5.mailing_address_line2, v5.mailing_address_state, v5.mailing_address_zip_code, v5.main_webpage_url, v6.master_profile, v5.medicaid_facility_number, v5.medicare_facility_number, case when v6.time_folder > v5.time_folder then v6.modtime else v5.modtime end as modtime, case when v6.time_folder > v5.time_folder then v6.organization_name else v5.organization_name end as organization_name, v6.practice_npi, case when v6.time_folder > v5.time_folder then v6.row_in_file else v5.row_in_file end as row_in_file, v5.services_offered_text_or_url, case when v6.time_folder > v5.time_folder then v6.time_folder else v5.time_folder end as time_folder, case when v6.time_folder > v5.time_folder then v6.tin else v5.tin end as tin from facility_v5_tomerge v5 join facility_v6_tomerge v6
                      on v5.practice_npi = v6.practice_npi
                      and v5.fk_facility_crosswalk_address = v6.fk_facility_crosswalk_address
                      and v5.master_profile = v6.master_profile
                      and v5.tin = v6.tin UNION select v5.filename as lineage_filename, v5.accreditation_body, v5.accreditation_status, v5.billing_fax, v5.billing_phone, v5.claim_remit_address_line1, v5.claim_remit_address_line2, v5.claim_remit_city, v5.claim_remit_name, v5.claim_remit_state, v5.claim_remit_zip_code, v5.clinical_staff_language_spoken1, v5.clinical_staff_language_spoken2, v5.clinical_staff_language_spoken3, v5.ecp_provider, v5.emr_type, v5.emr_version, '' as end_date, v5.facility_address_line1, v5.facility_address_line2, v5.facility_city, v5.facility_clia, v5.facility_county, v5.facility_fax, v5.facility_name_dba, v5.facility_state, v5.facility_telephone, v5.facility_type, v5.facility_zip_code, v5.fee_schedule, v5.filename, v5.filepath, v5.fk_facility_crosswalk_address, v5.fk_facility_golden_address_id, v5.fk_facility_legacy_ulid, v5.hc, v5.hours_of_operation_friday_end_time, v5.hours_of_operation_friday_start_time, v5.hours_of_operation_monday_end_time, v5.hours_of_operation_monday_start_time, v5.hours_of_operation_saturday_end_time, v5.hours_of_operation_saturday_start_time, v5.hours_of_operation_sunday_end_time, v5.hours_of_operation_sunday_start_time, v5.hours_of_operation_thursday_end_time, v5.hours_of_operation_thursday_start_time, v5.hours_of_operation_tuesday_end_time, v5.hours_of_operation_tuesday_start_time, v5.hours_of_operation_wednesday_end_time, v5.hours_of_operation_wednesday_start_time, v5.iops_data_factory_execution_message, v5.iops_data_factory_execution_status, v5.iops_data_factory_pipeline_run_id, v5.iops_provider_credentialing_method, v5.iops_request_create_datetime, v5.iops_roster_format, v5.iops_roster_type, v5.iops_trading_partner_id, v5.latest_data_rank, v5.mailing_address_city, v5.mailing_address_line1, v5.mailing_address_line2, v5.mailing_address_state, v5.mailing_address_zip_code, v5.main_webpage_url, v5.master_profile, v5.medicaid_facility_number, v5.medicare_facility_number, v5.modtime, v5.organization_name, v5.practice_npi, v5.row_in_file, v5.services_offered_text_or_url, v5.time_folder, v5.tin
                    FROM facility_v5_tomerge v5 LEFT JOIN facility_v6_tomerge v6 on v5.practice_npi = v6.practice_npi
                    and v5.fk_facility_crosswalk_address = v6.fk_facility_crosswalk_address
                    and v5.master_profile = v6.master_profile
                    and v5.tin = v6.tin
                    WHERE v6.practice_npi is NULL UNION select v5.filename as lineage_filename, v5.accreditation_body, v5.accreditation_status, v5.billing_fax, v5.billing_phone, v5.claim_remit_address_line1, v5.claim_remit_address_line2, v5.claim_remit_city, v5.claim_remit_name, v5.claim_remit_state, v5.claim_remit_zip_code, v5.clinical_staff_language_spoken1, v5.clinical_staff_language_spoken2, v5.clinical_staff_language_spoken3, v5.ecp_provider, v5.emr_type, v5.emr_version, '' as end_date, v5.facility_address_line1, v5.facility_address_line2, v5.facility_city, v5.facility_clia, v5.facility_county, v5.facility_fax, v5.facility_name_dba, v5.facility_state, v5.facility_telephone, v5.facility_type, v5.facility_zip_code, v5.fee_schedule, v5.filename, v5.filepath, v5.fk_facility_crosswalk_address, v5.fk_facility_golden_address_id, v5.fk_facility_legacy_ulid, v5.hc, v5.hours_of_operation_friday_end_time, v5.hours_of_operation_friday_start_time, v5.hours_of_operation_monday_end_time, v5.hours_of_operation_monday_start_time, v5.hours_of_operation_saturday_end_time, v5.hours_of_operation_saturday_start_time, v5.hours_of_operation_sunday_end_time, v5.hours_of_operation_sunday_start_time, v5.hours_of_operation_thursday_end_time, v5.hours_of_operation_thursday_start_time, v5.hours_of_operation_tuesday_end_time, v5.hours_of_operation_tuesday_start_time, v5.hours_of_operation_wednesday_end_time, v5.hours_of_operation_wednesday_start_time, v5.iops_data_factory_execution_message, v5.iops_data_factory_execution_status, v5.iops_data_factory_pipeline_run_id, v5.iops_provider_credentialing_method, v5.iops_request_create_datetime, v5.iops_roster_format, v5.iops_roster_type, v5.iops_trading_partner_id, v5.latest_data_rank, v5.mailing_address_city, v5.mailing_address_line1, v5.mailing_address_line2, v5.mailing_address_state, v5.mailing_address_zip_code, v5.main_webpage_url, v5.master_profile, v5.medicaid_facility_number, v5.medicare_facility_number, v5.modtime, v5.organization_name, v5.practice_npi, v5.row_in_file, v5.services_offered_text_or_url, v5.time_folder, v5.tin
                    FROM facility_v6_tomerge v6 LEFT JOIN facility_v5_tomerge v5 on v5.practice_npi = v6.practice_npi
                    and v5.fk_facility_crosswalk_address = v6.fk_facility_crosswalk_address
                    and v5.master_profile = v6.master_profile
                    and v5.tin = v6.tin
                    WHERE v5.practice_npi is NULL
**** versionMergedProfessional 
select concat (concat (v5.filename, ' ++ '), v6.filename) as lineage_filename, case when v6.time_folder > v5.time_folder then v6.accepting_new_bhp_patients else v5.accepting_new_bhp_patients end as accepting_new_bhp_patients, v5.area_of_expertise, v5.billing_email_address, v5.billing_fax, v5.billing_phone, case when v6.time_folder > v5.time_folder then v6.caqh else v5.caqh end as caqh, v5.chp_provider, v5.claim_remit_address_line1, v5.claim_remit_address_line2, v5.claim_remit_city, v5.claim_remit_name, v5.claim_remit_state, v5.claim_remit_zip_code, v5.clinical_staff_language_spoken1, v5.clinical_staff_language_spoken2, v5.clinical_staff_language_spoken3, v5.degree, case when v6.time_folder > v5.time_folder then v6.dob else v5.dob end as dob, v5.ecp_provider, v6.employed, v5.emr_type, v5.emr_version, v6.end_date, v5.fee_schdule, case when v6.time_folder > v5.time_folder then v6.filename else v5.filename end as filename, case when v6.time_folder > v5.time_folder then v6.filepath else v5.filepath end as filepath, case when v6.time_folder > v5.time_folder then v6.first_name else v5.first_name end as first_name, v5.fk_claim_remit_crosswalk_address, v5.fk_claim_remit_golden_address_id, v5.fk_claim_remit_legacy_ulid, v5.fk_mailing_crosswalk_address, v5.fk_mailing_golden_address_id, v5.fk_mailing_legacy_ulid, case when v6.time_folder > v5.time_folder then v6.fk_practice_crosswalk_address else v5.fk_practice_crosswalk_address end as fk_practice_crosswalk_address, case when v6.time_folder > v5.time_folder then v6.fk_practice_golden_address_id else v5.fk_practice_golden_address_id end as fk_practice_golden_address_id, case when v6.time_folder > v5.time_folder then v6.fk_practice_legacy_ulid else v5.fk_practice_legacy_ulid end as fk_practice_legacy_ulid, v5.future_first_day_of_employment, v5.future_last_day_of_employment, v5.gender, case when v6.time_folder > v5.time_folder then v6.hc else v5.hc end as hc, v6.hide_in_directory, case when v6.time_folder > v5.time_folder then v6.iops_data_factory_execution_message else v5.iops_data_factory_execution_message end as iops_data_factory_execution_message, case when v6.time_folder > v5.time_folder then v6.iops_data_factory_execution_status else v5.iops_data_factory_execution_status end as iops_data_factory_execution_status, case when v6.time_folder > v5.time_folder then v6.iops_data_factory_pipeline_run_id else v5.iops_data_factory_pipeline_run_id end as iops_data_factory_pipeline_run_id, case when v6.time_folder > v5.time_folder then v6.iops_provider_credentialing_method else v5.iops_provider_credentialing_method end as iops_provider_credentialing_method, case when v6.time_folder > v5.time_folder then v6.iops_request_create_datetime else v5.iops_request_create_datetime end as iops_request_create_datetime, case when v6.time_folder > v5.time_folder then v6.iops_roster_format else v5.iops_roster_format end as iops_roster_format, case when v6.time_folder > v5.time_folder then v6.iops_roster_type else v5.iops_roster_type end as iops_roster_type, case when v6.time_folder > v5.time_folder then v6.iops_trading_partner_id else v5.iops_trading_partner_id end as iops_trading_partner_id, v5.language_1, v5.language_2, v5.language_3, case when v6.time_folder > v5.time_folder then v6.last_name else v5.last_name end as last_name, case when v6.time_folder > v5.time_folder then v6.latest_data_rank else v5.latest_data_rank end as latest_data_rank, v5.license, v5.mailing_address_city, v5.mailing_address_line1, v5.mailing_address_line2, v5.mailing_address_state, v5.mailing_address_zip_code, v6.master_profile, v5.medicaid, v5.medicare, case when v6.time_folder > v5.time_folder then v6.middle_name else v5.middle_name end as middle_name, case when v6.time_folder > v5.time_folder then v6.modtime else v5.modtime end as modtime, v5.organization_name, v6.practice_address_line1, v6.practice_address_line2, v6.practice_city, v5.practice_county, case when v6.time_folder > v5.time_folder then v6.practice_fax else v5.practice_fax end as practice_fax, case when v6.time_folder > v5.time_folder then v6.practice_manager_email_address else v5.practice_manager_email_address end as practice_manager_email_address, case when v6.time_folder > v5.time_folder then v6.practice_name_dba else v5.practice_name_dba end as practice_name_dba, case when v6.time_folder > v5.time_folder then v6.practice_npi else v5.practice_npi end as practice_npi, v6.practice_state, case when v6.time_folder > v5.time_folder then v6.practice_telephone else v5.practice_telephone end as practice_telephone, v5.practice_webpage_url, v6.practice_zip_code, case when v6.time_folder > v5.time_folder then v6.provider_email_address else v5.provider_email_address end as provider_email_address, v6.provider_npi, v5.provider_type, case when v6.time_folder > v5.time_folder then v6.row_in_file else v5.row_in_file end as row_in_file, case when v6.time_folder > v5.time_folder then v6.specialty else v5.specialty end as specialty, case when v6.time_folder > v5.time_folder then v6.ssn else v5.ssn end as ssn, case when v6.time_folder > v5.time_folder then v6.time_folder else v5.time_folder end as time_folder, v5.tin from professional_v5_tomerge v5 join professional_v6_tomerge v6
                      on v5.provider_npi = v6.provider_npi
                      and v5.fk_practice_crosswalk_address = v6.fk_practice_crosswalk_address
                      and v5.master_profile = v6.master_profile
                       UNION select v5.filename as lineage_filename, v5.accepting_new_bhp_patients, v5.area_of_expertise, v5.billing_email_address, v5.billing_fax, v5.billing_phone, v5.caqh, v5.chp_provider, v5.claim_remit_address_line1, v5.claim_remit_address_line2, v5.claim_remit_city, v5.claim_remit_name, v5.claim_remit_state, v5.claim_remit_zip_code, v5.clinical_staff_language_spoken1, v5.clinical_staff_language_spoken2, v5.clinical_staff_language_spoken3, v5.degree, v5.dob, v5.ecp_provider, '' as employed, v5.emr_type, v5.emr_version, '' as end_date, v5.fee_schdule, v5.filename, v5.filepath, v5.first_name, v5.fk_claim_remit_crosswalk_address, v5.fk_claim_remit_golden_address_id, v5.fk_claim_remit_legacy_ulid, v5.fk_mailing_crosswalk_address, v5.fk_mailing_golden_address_id, v5.fk_mailing_legacy_ulid, v5.fk_practice_crosswalk_address, v5.fk_practice_golden_address_id, v5.fk_practice_legacy_ulid, v5.future_first_day_of_employment, v5.future_last_day_of_employment, v5.gender, v5.hc, '' as hide_in_directory, v5.iops_data_factory_execution_message, v5.iops_data_factory_execution_status, v5.iops_data_factory_pipeline_run_id, v5.iops_provider_credentialing_method, v5.iops_request_create_datetime, v5.iops_roster_format, v5.iops_roster_type, v5.iops_trading_partner_id, v5.language_1, v5.language_2, v5.language_3, v5.last_name, v5.latest_data_rank, v5.license, v5.mailing_address_city, v5.mailing_address_line1, v5.mailing_address_line2, v5.mailing_address_state, v5.mailing_address_zip_code, v5.master_profile, v5.medicaid, v5.medicare, v5.middle_name, v5.modtime, v5.organization_name, v5.practice_address_line1, v5.practice_address_line2, v5.practice_city, v5.practice_county, v5.practice_fax, v5.practice_manager_email_address, v5.practice_name_dba, v5.practice_npi, v5.practice_state, v5.practice_telephone, v5.practice_webpage_url, v5.practice_zip_code, v5.provider_email_address, v5.provider_npi, v5.provider_type, v5.row_in_file, v5.specialty, v5.ssn, v5.time_folder, v5.tin
                    FROM professional_v5_tomerge v5 LEFT JOIN professional_v6_tomerge v6 on v5.provider_npi = v6.provider_npi
                    and v5.fk_practice_crosswalk_address = v6.fk_practice_crosswalk_address
                    and v5.master_profile = v6.master_profile
                    WHERE v6.provider_npi is NULL UNION select v5.filename as lineage_filename, v5.accepting_new_bhp_patients, v5.area_of_expertise, v5.billing_email_address, v5.billing_fax, v5.billing_phone, v5.caqh, v5.chp_provider, v5.claim_remit_address_line1, v5.claim_remit_address_line2, v5.claim_remit_city, v5.claim_remit_name, v5.claim_remit_state, v5.claim_remit_zip_code, v5.clinical_staff_language_spoken1, v5.clinical_staff_language_spoken2, v5.clinical_staff_language_spoken3, v5.degree, v5.dob, v5.ecp_provider, '' as employed, v5.emr_type, v5.emr_version, '' as end_date, v5.fee_schdule, v5.filename, v5.filepath, v5.first_name, v5.fk_claim_remit_crosswalk_address, v5.fk_claim_remit_golden_address_id, v5.fk_claim_remit_legacy_ulid, v5.fk_mailing_crosswalk_address, v5.fk_mailing_golden_address_id, v5.fk_mailing_legacy_ulid, v5.fk_practice_crosswalk_address, v5.fk_practice_golden_address_id, v5.fk_practice_legacy_ulid, v5.future_first_day_of_employment, v5.future_last_day_of_employment, v5.gender, v5.hc, '' as hide_in_directory, v5.iops_data_factory_execution_message, v5.iops_data_factory_execution_status, v5.iops_data_factory_pipeline_run_id, v5.iops_provider_credentialing_method, v5.iops_request_create_datetime, v5.iops_roster_format, v5.iops_roster_type, v5.iops_trading_partner_id, v5.language_1, v5.language_2, v5.language_3, v5.last_name, v5.latest_data_rank, v5.license, v5.mailing_address_city, v5.mailing_address_line1, v5.mailing_address_line2, v5.mailing_address_state, v5.mailing_address_zip_code, v5.master_profile, v5.medicaid, v5.medicare, v5.middle_name, v5.modtime, v5.organization_name, v5.practice_address_line1, v5.practice_address_line2, v5.practice_city, v5.practice_county, v5.practice_fax, v5.practice_manager_email_address, v5.practice_name_dba, v5.practice_npi, v5.practice_state, v5.practice_telephone, v5.practice_webpage_url, v5.practice_zip_code, v5.provider_email_address, v5.provider_npi, v5.provider_type, v5.row_in_file, v5.specialty, v5.ssn, v5.time_folder, v5.tin
                    FROM professional_v6_tomerge v6 LEFT JOIN professional_v5_tomerge v5 on v5.provider_npi = v6.provider_npi
                    and v5.fk_practice_crosswalk_address = v6.fk_practice_crosswalk_address
                    and v5.master_profile = v6.master_profile
                    WHERE v5.provider_npi is NULL
(Wed Sep 23 20:18:38 UTC 2020)- [/mnt/ods/bdp_2020_09_23_small_abtest_original_coalesced/facility_merged-.parquet] finished writing in (3) secs
(Wed Sep 23 20:18:49 UTC 2020)- [/mnt/ods/bdp_2020_09_23_small_abtest_original_coalesced/professional_merged-.parquet] finished writing in (10) secs


*** version merged dfs
[facility_merged] 579
[professional_merged] 21947
**** mergeProfessionalFacilityHelper 
select '1' as entity_type_code, provider_npi as plbt_npi, provider_npi as provider_npi, practice_npi as practice_npi, master_profile,
           fk_practice_golden_address_id, fk_practice_crosswalk_address,
           practice_address_line1, practice_address_line2, practice_city, practice_state, practice_zip_code,
           tin as plbt_tin, tin as provider_tin,
        '' as practice_tin, accepting_new_bhp_patients, '' as accreditation_body, '' as accreditation_status, area_of_expertise, billing_email_address, billing_fax, billing_phone, caqh, chp_provider, claim_remit_address_line1, claim_remit_address_line2, claim_remit_city, claim_remit_name, claim_remit_state, claim_remit_zip_code, clinical_staff_language_spoken1, clinical_staff_language_spoken2, clinical_staff_language_spoken3, degree, dob, ecp_provider, employed, emr_type, emr_version, end_date, '' as facility_address_line1, '' as facility_address_line2, '' as facility_city, '' as facility_clia, '' as facility_county, '' as facility_fax, '' as facility_name_dba, '' as facility_state, '' as facility_telephone, '' as facility_type, '' as facility_zip_code, fee_schdule, '' as fee_schedule, filename, filepath, first_name, fk_claim_remit_crosswalk_address, fk_claim_remit_golden_address_id, fk_claim_remit_legacy_ulid, '' as fk_facility_crosswalk_address, '' as fk_facility_golden_address_id, '' as fk_facility_legacy_ulid, fk_mailing_crosswalk_address, fk_mailing_golden_address_id, fk_mailing_legacy_ulid, fk_practice_legacy_ulid, future_first_day_of_employment, future_last_day_of_employment, gender, hc, hide_in_directory, '' as hours_of_operation_friday_end_time, '' as hours_of_operation_friday_start_time, '' as hours_of_operation_monday_end_time, '' as hours_of_operation_monday_start_time, '' as hours_of_operation_saturday_end_time, '' as hours_of_operation_saturday_start_time, '' as hours_of_operation_sunday_end_time, '' as hours_of_operation_sunday_start_time, '' as hours_of_operation_thursday_end_time, '' as hours_of_operation_thursday_start_time, '' as hours_of_operation_tuesday_end_time, '' as hours_of_operation_tuesday_start_time, '' as hours_of_operation_wednesday_end_time, '' as hours_of_operation_wednesday_start_time, iops_data_factory_execution_message, iops_data_factory_execution_status, iops_data_factory_pipeline_run_id, iops_provider_credentialing_method, iops_request_create_datetime, iops_roster_format, iops_roster_type, iops_trading_partner_id, language_1, language_2, language_3, last_name, latest_data_rank, license, lineage_filename, mailing_address_city, mailing_address_line1, mailing_address_line2, mailing_address_state, mailing_address_zip_code, '' as main_webpage_url, medicaid, '' as medicaid_facility_number, medicare, '' as medicare_facility_number, middle_name, modtime, organization_name, practice_county, practice_fax, practice_manager_email_address, practice_name_dba, practice_telephone, practice_webpage_url, provider_email_address, provider_type, row_in_file, '' as services_offered_text_or_url, specialty, ssn, time_folder FROM professional_merged UNION select '0' as entity_type_code, practice_npi as plbt_npi, '' as provider_npi, practice_npi as practice_npi, master_profile,
           fk_facility_golden_address_id as fk_practice_golden_address_id, fk_facility_crosswalk_address as fk_practice_crosswalk_address,
           facility_address_line1 as practice_address_line1, facility_address_line2 as practice_address_line2,
           facility_city as practice_city, facility_state as practice_state, facility_zip_code as practice_zip_code,
           tin as plbt_tin, '' as provider_tin, tin as practice_tin
        , '' as accepting_new_bhp_patients, accreditation_body, accreditation_status, '' as area_of_expertise, '' as billing_email_address, billing_fax, billing_phone, '' as caqh, '' as chp_provider, claim_remit_address_line1, claim_remit_address_line2, claim_remit_city, claim_remit_name, claim_remit_state, claim_remit_zip_code, clinical_staff_language_spoken1, clinical_staff_language_spoken2, clinical_staff_language_spoken3, '' as degree, '' as dob, ecp_provider, '' as employed, emr_type, emr_version, end_date, facility_address_line1, facility_address_line2, facility_city, facility_clia, facility_county, facility_fax, facility_name_dba, facility_state, facility_telephone, facility_type, facility_zip_code, '' as fee_schdule, fee_schedule, filename, filepath, '' as first_name, '' as fk_claim_remit_crosswalk_address, '' as fk_claim_remit_golden_address_id, '' as fk_claim_remit_legacy_ulid, fk_facility_crosswalk_address, fk_facility_golden_address_id, fk_facility_legacy_ulid, '' as fk_mailing_crosswalk_address, '' as fk_mailing_golden_address_id, '' as fk_mailing_legacy_ulid, '' as fk_practice_legacy_ulid, '' as future_first_day_of_employment, '' as future_last_day_of_employment, '' as gender, hc, '' as hide_in_directory, hours_of_operation_friday_end_time, hours_of_operation_friday_start_time, hours_of_operation_monday_end_time, hours_of_operation_monday_start_time, hours_of_operation_saturday_end_time, hours_of_operation_saturday_start_time, hours_of_operation_sunday_end_time, hours_of_operation_sunday_start_time, hours_of_operation_thursday_end_time, hours_of_operation_thursday_start_time, hours_of_operation_tuesday_end_time, hours_of_operation_tuesday_start_time, hours_of_operation_wednesday_end_time, hours_of_operation_wednesday_start_time, iops_data_factory_execution_message, iops_data_factory_execution_status, iops_data_factory_pipeline_run_id, iops_provider_credentialing_method, iops_request_create_datetime, iops_roster_format, iops_roster_type, iops_trading_partner_id, '' as language_1, '' as language_2, '' as language_3, '' as last_name, latest_data_rank, '' as license, lineage_filename, mailing_address_city, mailing_address_line1, mailing_address_line2, mailing_address_state, mailing_address_zip_code, main_webpage_url, '' as medicaid, medicaid_facility_number, '' as medicare, medicare_facility_number, '' as middle_name, modtime, organization_name, '' as practice_county, '' as practice_fax, '' as practice_manager_email_address, '' as practice_name_dba, '' as practice_telephone, '' as practice_webpage_url, '' as provider_email_address, '' as provider_type, row_in_file, services_offered_text_or_url, '' as specialty, '' as ssn, time_folder FROM facility_merged
(Wed Sep 23 20:19:18 UTC 2020)- [/mnt/ods/bdp_2020_09_23_small_abtest_original_coalesced/plbt-.parquet] finished writing in (14) secs


*** PLBT
[plbt] 22526


===============Big Run===============
"/mnt/billing/GDP001/runlog/", "/mnt/ods/bdp_2020_09_23_big_abtest_original/"

*** Original dfs
[professional_v6] 396168
[professional_v5] 2585117
[facility_v6] 16128
[facility_v5] 32350


*** Simple dedup dfs
[professional_v6] 191130
[professional_v5] 376665
[facility_v6] 6908
[facility_v5] 14276
**** versionMergedFacility 
select concat (concat (v5.filename, ' ++ '), v6.filename) as lineage_filename, v5.accreditation_body, v5.accreditation_status, v5.billing_fax, v5.billing_phone, v5.claim_remit_address_line1, v5.claim_remit_address_line2, v5.claim_remit_city, v5.claim_remit_name, v5.claim_remit_state, v5.claim_remit_zip_code, v5.clinical_staff_language_spoken1, v5.clinical_staff_language_spoken2, v5.clinical_staff_language_spoken3, v5.ecp_provider, v5.emr_type, v5.emr_version, case when v6.time_folder > v5.time_folder then v6.end_date else v5.end_date end as end_date, v6.facility_address_line1, v6.facility_address_line2, v6.facility_city, v5.facility_clia, v5.facility_county, case when v6.time_folder > v5.time_folder then v6.facility_fax else v5.facility_fax end as facility_fax, case when v6.time_folder > v5.time_folder then v6.facility_name_dba else v5.facility_name_dba end as facility_name_dba, v6.facility_state, case when v6.time_folder > v5.time_folder then v6.facility_telephone else v5.facility_telephone end as facility_telephone, case when v6.time_folder > v5.time_folder then v6.facility_type else v5.facility_type end as facility_type, v6.facility_zip_code, v5.fee_schedule, case when v6.time_folder > v5.time_folder then v6.filename else v5.filename end as filename, case when v6.time_folder > v5.time_folder then v6.filepath else v5.filepath end as filepath, case when v6.time_folder > v5.time_folder then v6.fk_facility_crosswalk_address else v5.fk_facility_crosswalk_address end as fk_facility_crosswalk_address, case when v6.time_folder > v5.time_folder then v6.fk_facility_golden_address_id else v5.fk_facility_golden_address_id end as fk_facility_golden_address_id, case when v6.time_folder > v5.time_folder then v6.fk_facility_legacy_ulid else v5.fk_facility_legacy_ulid end as fk_facility_legacy_ulid, case when v6.time_folder > v5.time_folder then v6.hc else v5.hc end as hc, v5.hide_in_directory, v5.hours_of_operation_friday_end_time, v5.hours_of_operation_friday_start_time, v5.hours_of_operation_monday_end_time, v5.hours_of_operation_monday_start_time, v5.hours_of_operation_saturday_end_time, v5.hours_of_operation_saturday_start_time, v5.hours_of_operation_sunday_end_time, v5.hours_of_operation_sunday_start_time, v5.hours_of_operation_thursday_end_time, v5.hours_of_operation_thursday_start_time, v5.hours_of_operation_tuesday_end_time, v5.hours_of_operation_tuesday_start_time, v5.hours_of_operation_wednesday_end_time, v5.hours_of_operation_wednesday_start_time, case when v6.time_folder > v5.time_folder then v6.iops_data_factory_execution_message else v5.iops_data_factory_execution_message end as iops_data_factory_execution_message, case when v6.time_folder > v5.time_folder then v6.iops_data_factory_execution_status else v5.iops_data_factory_execution_status end as iops_data_factory_execution_status, case when v6.time_folder > v5.time_folder then v6.iops_data_factory_pipeline_run_id else v5.iops_data_factory_pipeline_run_id end as iops_data_factory_pipeline_run_id, case when v6.time_folder > v5.time_folder then v6.iops_provider_credentialing_method else v5.iops_provider_credentialing_method end as iops_provider_credentialing_method, case when v6.time_folder > v5.time_folder then v6.iops_request_create_datetime else v5.iops_request_create_datetime end as iops_request_create_datetime, case when v6.time_folder > v5.time_folder then v6.iops_roster_format else v5.iops_roster_format end as iops_roster_format, case when v6.time_folder > v5.time_folder then v6.iops_roster_type else v5.iops_roster_type end as iops_roster_type, case when v6.time_folder > v5.time_folder then v6.iops_trading_partner_id else v5.iops_trading_partner_id end as iops_trading_partner_id, case when v6.time_folder > v5.time_folder then v6.latest_data_rank else v5.latest_data_rank end as latest_data_rank, v5.mailing_address_city, v5.mailing_address_line1, v5.mailing_address_line2, v5.mailing_address_state, v5.mailing_address_zip_code, v5.main_webpage_url, v6.master_profile, v5.medicaid_facility_number, v5.medicare_facility_number, case when v6.time_folder > v5.time_folder then v6.modtime else v5.modtime end as modtime, case when v6.time_folder > v5.time_folder then v6.organization_name else v5.organization_name end as organization_name, v6.practice_npi, case when v6.time_folder > v5.time_folder then v6.row_in_file else v5.row_in_file end as row_in_file, v5.services_offered_text_or_url, v6.start_date, case when v6.time_folder > v5.time_folder then v6.time_folder else v5.time_folder end as time_folder, case when v6.time_folder > v5.time_folder then v6.tin else v5.tin end as tin from facility_v5_tomerge v5 join facility_v6_tomerge v6
                      on v5.practice_npi = v6.practice_npi
                      and v5.fk_facility_crosswalk_address = v6.fk_facility_crosswalk_address
                      and v5.master_profile = v6.master_profile
                      and v5.tin = v6.tin UNION select v5.filename as lineage_filename, v5.accreditation_body, v5.accreditation_status, v5.billing_fax, v5.billing_phone, v5.claim_remit_address_line1, v5.claim_remit_address_line2, v5.claim_remit_city, v5.claim_remit_name, v5.claim_remit_state, v5.claim_remit_zip_code, v5.clinical_staff_language_spoken1, v5.clinical_staff_language_spoken2, v5.clinical_staff_language_spoken3, v5.ecp_provider, v5.emr_type, v5.emr_version, v5.end_date, v5.facility_address_line1, v5.facility_address_line2, v5.facility_city, v5.facility_clia, v5.facility_county, v5.facility_fax, v5.facility_name_dba, v5.facility_state, v5.facility_telephone, v5.facility_type, v5.facility_zip_code, v5.fee_schedule, v5.filename, v5.filepath, v5.fk_facility_crosswalk_address, v5.fk_facility_golden_address_id, v5.fk_facility_legacy_ulid, v5.hc, v5.hide_in_directory, v5.hours_of_operation_friday_end_time, v5.hours_of_operation_friday_start_time, v5.hours_of_operation_monday_end_time, v5.hours_of_operation_monday_start_time, v5.hours_of_operation_saturday_end_time, v5.hours_of_operation_saturday_start_time, v5.hours_of_operation_sunday_end_time, v5.hours_of_operation_sunday_start_time, v5.hours_of_operation_thursday_end_time, v5.hours_of_operation_thursday_start_time, v5.hours_of_operation_tuesday_end_time, v5.hours_of_operation_tuesday_start_time, v5.hours_of_operation_wednesday_end_time, v5.hours_of_operation_wednesday_start_time, v5.iops_data_factory_execution_message, v5.iops_data_factory_execution_status, v5.iops_data_factory_pipeline_run_id, v5.iops_provider_credentialing_method, v5.iops_request_create_datetime, v5.iops_roster_format, v5.iops_roster_type, v5.iops_trading_partner_id, v5.latest_data_rank, v5.mailing_address_city, v5.mailing_address_line1, v5.mailing_address_line2, v5.mailing_address_state, v5.mailing_address_zip_code, v5.main_webpage_url, v5.master_profile, v5.medicaid_facility_number, v5.medicare_facility_number, v5.modtime, v5.organization_name, v5.practice_npi, v5.row_in_file, v5.services_offered_text_or_url, '' as start_date, v5.time_folder, v5.tin
                    FROM facility_v5_tomerge v5 LEFT JOIN facility_v6_tomerge v6 on v5.practice_npi = v6.practice_npi
                    and v5.fk_facility_crosswalk_address = v6.fk_facility_crosswalk_address
                    and v5.master_profile = v6.master_profile
                    and v5.tin = v6.tin
                    WHERE v6.practice_npi is NULL UNION select v5.filename as lineage_filename, v5.accreditation_body, v5.accreditation_status, v5.billing_fax, v5.billing_phone, v5.claim_remit_address_line1, v5.claim_remit_address_line2, v5.claim_remit_city, v5.claim_remit_name, v5.claim_remit_state, v5.claim_remit_zip_code, v5.clinical_staff_language_spoken1, v5.clinical_staff_language_spoken2, v5.clinical_staff_language_spoken3, v5.ecp_provider, v5.emr_type, v5.emr_version, v5.end_date, v5.facility_address_line1, v5.facility_address_line2, v5.facility_city, v5.facility_clia, v5.facility_county, v5.facility_fax, v5.facility_name_dba, v5.facility_state, v5.facility_telephone, v5.facility_type, v5.facility_zip_code, v5.fee_schedule, v5.filename, v5.filepath, v5.fk_facility_crosswalk_address, v5.fk_facility_golden_address_id, v5.fk_facility_legacy_ulid, v5.hc, v5.hide_in_directory, v5.hours_of_operation_friday_end_time, v5.hours_of_operation_friday_start_time, v5.hours_of_operation_monday_end_time, v5.hours_of_operation_monday_start_time, v5.hours_of_operation_saturday_end_time, v5.hours_of_operation_saturday_start_time, v5.hours_of_operation_sunday_end_time, v5.hours_of_operation_sunday_start_time, v5.hours_of_operation_thursday_end_time, v5.hours_of_operation_thursday_start_time, v5.hours_of_operation_tuesday_end_time, v5.hours_of_operation_tuesday_start_time, v5.hours_of_operation_wednesday_end_time, v5.hours_of_operation_wednesday_start_time, v5.iops_data_factory_execution_message, v5.iops_data_factory_execution_status, v5.iops_data_factory_pipeline_run_id, v5.iops_provider_credentialing_method, v5.iops_request_create_datetime, v5.iops_roster_format, v5.iops_roster_type, v5.iops_trading_partner_id, v5.latest_data_rank, v5.mailing_address_city, v5.mailing_address_line1, v5.mailing_address_line2, v5.mailing_address_state, v5.mailing_address_zip_code, v5.main_webpage_url, v5.master_profile, v5.medicaid_facility_number, v5.medicare_facility_number, v5.modtime, v5.organization_name, v5.practice_npi, v5.row_in_file, v5.services_offered_text_or_url, '' as start_date, v5.time_folder, v5.tin
                    FROM facility_v6_tomerge v6 LEFT JOIN facility_v5_tomerge v5 on v5.practice_npi = v6.practice_npi
                    and v5.fk_facility_crosswalk_address = v6.fk_facility_crosswalk_address
                    and v5.master_profile = v6.master_profile
                    and v5.tin = v6.tin
                    WHERE v5.practice_npi is NULL
**** versionMergedProfessional 
select concat (concat (v5.filename, ' ++ '), v6.filename) as lineage_filename, case when v6.time_folder > v5.time_folder then v6.accepting_new_bhp_patients else v5.accepting_new_bhp_patients end as accepting_new_bhp_patients, v5.area_of_expertise, v5.billing_email_address, v5.billing_fax, v5.billing_phone, case when v6.time_folder > v5.time_folder then v6.caqh else v5.caqh end as caqh, v5.chp_provider, v5.claim_remit_address_line1, v5.claim_remit_address_line2, v5.claim_remit_city, v5.claim_remit_name, v5.claim_remit_state, v5.claim_remit_zip_code, v5.clinical_staff_language_spoken1, v5.clinical_staff_language_spoken2, v5.clinical_staff_language_spoken3, v5.cred_status, case when v6.time_folder > v5.time_folder then v6.degree else v5.degree end as degree, case when v6.time_folder > v5.time_folder then v6.dob else v5.dob end as dob, v5.ecp_provider, case when v6.time_folder > v5.time_folder then v6.employed else v5.employed end as employed, v5.emr_type, v5.emr_version, case when v6.time_folder > v5.time_folder then v6.end_date else v5.end_date end as end_date, v5.fee_schdule, case when v6.time_folder > v5.time_folder then v6.filename else v5.filename end as filename, case when v6.time_folder > v5.time_folder then v6.filepath else v5.filepath end as filepath, case when v6.time_folder > v5.time_folder then v6.first_name else v5.first_name end as first_name, v5.fk_claim_remit_crosswalk_address, v5.fk_claim_remit_golden_address_id, v5.fk_claim_remit_legacy_ulid, v5.fk_mailing_crosswalk_address, v5.fk_mailing_golden_address_id, v5.fk_mailing_legacy_ulid, case when v6.time_folder > v5.time_folder then v6.fk_practice_crosswalk_address else v5.fk_practice_crosswalk_address end as fk_practice_crosswalk_address, case when v6.time_folder > v5.time_folder then v6.fk_practice_golden_address_id else v5.fk_practice_golden_address_id end as fk_practice_golden_address_id, case when v6.time_folder > v5.time_folder then v6.fk_practice_legacy_ulid else v5.fk_practice_legacy_ulid end as fk_practice_legacy_ulid, v5.future_first_day_of_employment, v5.future_last_day_of_employment, v5.gender, case when v6.time_folder > v5.time_folder then v6.hc else v5.hc end as hc, case when v6.time_folder > v5.time_folder then v6.hide_in_directory else v5.hide_in_directory end as hide_in_directory, case when v6.time_folder > v5.time_folder then v6.iops_data_factory_execution_message else v5.iops_data_factory_execution_message end as iops_data_factory_execution_message, case when v6.time_folder > v5.time_folder then v6.iops_data_factory_execution_status else v5.iops_data_factory_execution_status end as iops_data_factory_execution_status, case when v6.time_folder > v5.time_folder then v6.iops_data_factory_pipeline_run_id else v5.iops_data_factory_pipeline_run_id end as iops_data_factory_pipeline_run_id, case when v6.time_folder > v5.time_folder then v6.iops_provider_credentialing_method else v5.iops_provider_credentialing_method end as iops_provider_credentialing_method, case when v6.time_folder > v5.time_folder then v6.iops_request_create_datetime else v5.iops_request_create_datetime end as iops_request_create_datetime, case when v6.time_folder > v5.time_folder then v6.iops_roster_format else v5.iops_roster_format end as iops_roster_format, case when v6.time_folder > v5.time_folder then v6.iops_roster_type else v5.iops_roster_type end as iops_roster_type, case when v6.time_folder > v5.time_folder then v6.iops_trading_partner_id else v5.iops_trading_partner_id end as iops_trading_partner_id, v5.language_1, v5.language_2, v5.language_3, case when v6.time_folder > v5.time_folder then v6.last_name else v5.last_name end as last_name, case when v6.time_folder > v5.time_folder then v6.latest_data_rank else v5.latest_data_rank end as latest_data_rank, v5.license, case when v6.time_folder > v5.time_folder then v6.mailing_address_city else v5.mailing_address_city end as mailing_address_city, case when v6.time_folder > v5.time_folder then v6.mailing_address_line1 else v5.mailing_address_line1 end as mailing_address_line1, case when v6.time_folder > v5.time_folder then v6.mailing_address_line2 else v5.mailing_address_line2 end as mailing_address_line2, case when v6.time_folder > v5.time_folder then v6.mailing_address_state else v5.mailing_address_state end as mailing_address_state, case when v6.time_folder > v5.time_folder then v6.mailing_address_zip_code else v5.mailing_address_zip_code end as mailing_address_zip_code, v6.master_profile, v5.medicaid, v5.medicare, case when v6.time_folder > v5.time_folder then v6.middle_name else v5.middle_name end as middle_name, case when v6.time_folder > v5.time_folder then v6.modtime else v5.modtime end as modtime, v5.organization_name, v6.practice_address_line1, v6.practice_address_line2, v6.practice_city, v5.practice_county, case when v6.time_folder > v5.time_folder then v6.practice_fax else v5.practice_fax end as practice_fax, case when v6.time_folder > v5.time_folder then v6.practice_manager_email_address else v5.practice_manager_email_address end as practice_manager_email_address, case when v6.time_folder > v5.time_folder then v6.practice_name_dba else v5.practice_name_dba end as practice_name_dba, case when v6.time_folder > v5.time_folder then v6.practice_npi else v5.practice_npi end as practice_npi, v6.practice_state, case when v6.time_folder > v5.time_folder then v6.practice_telephone else v5.practice_telephone end as practice_telephone, v6.practice_tin, v5.practice_webpage_url, v6.practice_zip_code, v5.preferred_communication_method, case when v6.time_folder > v5.time_folder then v6.provider_email_address else v5.provider_email_address end as provider_email_address, v6.provider_npi, v5.provider_type, case when v6.time_folder > v5.time_folder then v6.row_in_file else v5.row_in_file end as row_in_file, case when v6.time_folder > v5.time_folder then v6.specialty else v5.specialty end as specialty, case when v6.time_folder > v5.time_folder then v6.ssn else v5.ssn end as ssn, v6.start_date, case when v6.time_folder > v5.time_folder then v6.time_folder else v5.time_folder end as time_folder, v5.tin from professional_v5_tomerge v5 join professional_v6_tomerge v6
                      on v5.provider_npi = v6.provider_npi
                      and v5.fk_practice_crosswalk_address = v6.fk_practice_crosswalk_address
                      and v5.master_profile = v6.master_profile
                       UNION select v5.filename as lineage_filename, v5.accepting_new_bhp_patients, v5.area_of_expertise, v5.billing_email_address, v5.billing_fax, v5.billing_phone, v5.caqh, v5.chp_provider, v5.claim_remit_address_line1, v5.claim_remit_address_line2, v5.claim_remit_city, v5.claim_remit_name, v5.claim_remit_state, v5.claim_remit_zip_code, v5.clinical_staff_language_spoken1, v5.clinical_staff_language_spoken2, v5.clinical_staff_language_spoken3, v5.cred_status, v5.degree, v5.dob, v5.ecp_provider, v5.employed, v5.emr_type, v5.emr_version, v5.end_date, v5.fee_schdule, v5.filename, v5.filepath, v5.first_name, v5.fk_claim_remit_crosswalk_address, v5.fk_claim_remit_golden_address_id, v5.fk_claim_remit_legacy_ulid, v5.fk_mailing_crosswalk_address, v5.fk_mailing_golden_address_id, v5.fk_mailing_legacy_ulid, v5.fk_practice_crosswalk_address, v5.fk_practice_golden_address_id, v5.fk_practice_legacy_ulid, v5.future_first_day_of_employment, v5.future_last_day_of_employment, v5.gender, v5.hc, v5.hide_in_directory, v5.iops_data_factory_execution_message, v5.iops_data_factory_execution_status, v5.iops_data_factory_pipeline_run_id, v5.iops_provider_credentialing_method, v5.iops_request_create_datetime, v5.iops_roster_format, v5.iops_roster_type, v5.iops_trading_partner_id, v5.language_1, v5.language_2, v5.language_3, v5.last_name, v5.latest_data_rank, v5.license, v5.mailing_address_city, v5.mailing_address_line1, v5.mailing_address_line2, v5.mailing_address_state, v5.mailing_address_zip_code, v5.master_profile, v5.medicaid, v5.medicare, v5.middle_name, v5.modtime, v5.organization_name, v5.practice_address_line1, v5.practice_address_line2, v5.practice_city, v5.practice_county, v5.practice_fax, v5.practice_manager_email_address, v5.practice_name_dba, v5.practice_npi, v5.practice_state, v5.practice_telephone, '' as practice_tin, v5.practice_webpage_url, v5.practice_zip_code, v5.preferred_communication_method, v5.provider_email_address, v5.provider_npi, v5.provider_type, v5.row_in_file, v5.specialty, v5.ssn, '' as start_date, v5.time_folder, v5.tin
                    FROM professional_v5_tomerge v5 LEFT JOIN professional_v6_tomerge v6 on v5.provider_npi = v6.provider_npi
                    and v5.fk_practice_crosswalk_address = v6.fk_practice_crosswalk_address
                    and v5.master_profile = v6.master_profile
                    WHERE v6.provider_npi is NULL UNION select v5.filename as lineage_filename, v5.accepting_new_bhp_patients, v5.area_of_expertise, v5.billing_email_address, v5.billing_fax, v5.billing_phone, v5.caqh, v5.chp_provider, v5.claim_remit_address_line1, v5.claim_remit_address_line2, v5.claim_remit_city, v5.claim_remit_name, v5.claim_remit_state, v5.claim_remit_zip_code, v5.clinical_staff_language_spoken1, v5.clinical_staff_language_spoken2, v5.clinical_staff_language_spoken3, v5.cred_status, v5.degree, v5.dob, v5.ecp_provider, v5.employed, v5.emr_type, v5.emr_version, v5.end_date, v5.fee_schdule, v5.filename, v5.filepath, v5.first_name, v5.fk_claim_remit_crosswalk_address, v5.fk_claim_remit_golden_address_id, v5.fk_claim_remit_legacy_ulid, v5.fk_mailing_crosswalk_address, v5.fk_mailing_golden_address_id, v5.fk_mailing_legacy_ulid, v5.fk_practice_crosswalk_address, v5.fk_practice_golden_address_id, v5.fk_practice_legacy_ulid, v5.future_first_day_of_employment, v5.future_last_day_of_employment, v5.gender, v5.hc, v5.hide_in_directory, v5.iops_data_factory_execution_message, v5.iops_data_factory_execution_status, v5.iops_data_factory_pipeline_run_id, v5.iops_provider_credentialing_method, v5.iops_request_create_datetime, v5.iops_roster_format, v5.iops_roster_type, v5.iops_trading_partner_id, v5.language_1, v5.language_2, v5.language_3, v5.last_name, v5.latest_data_rank, v5.license, v5.mailing_address_city, v5.mailing_address_line1, v5.mailing_address_line2, v5.mailing_address_state, v5.mailing_address_zip_code, v5.master_profile, v5.medicaid, v5.medicare, v5.middle_name, v5.modtime, v5.organization_name, v5.practice_address_line1, v5.practice_address_line2, v5.practice_city, v5.practice_county, v5.practice_fax, v5.practice_manager_email_address, v5.practice_name_dba, v5.practice_npi, v5.practice_state, v5.practice_telephone, '' as practice_tin, v5.practice_webpage_url, v5.practice_zip_code, v5.preferred_communication_method, v5.provider_email_address, v5.provider_npi, v5.provider_type, v5.row_in_file, v5.specialty, v5.ssn, '' as start_date, v5.time_folder, v5.tin
                    FROM professional_v6_tomerge v6 LEFT JOIN professional_v5_tomerge v5 on v5.provider_npi = v6.provider_npi
                    and v5.fk_practice_crosswalk_address = v6.fk_practice_crosswalk_address
                    and v5.master_profile = v6.master_profile
                    WHERE v5.provider_npi is NULL
(Wed Sep 23 20:59:50 UTC 2020)- [/mnt/ods/bdp_2020_09_23_big_abtest_original_coalesced/facility_merged-.parquet] finished writing in (24) secs
(Wed Sep 23 21:01:07 UTC 2020)- [/mnt/ods/bdp_2020_09_23_big_abtest_original_coalesced/professional_merged-.parquet] finished writing in (77) secs


*** version merged dfs
[facility_merged] 14277
[professional_merged] 376666
**** mergeProfessionalFacilityHelper 
select '1' as entity_type_code, provider_npi as plbt_npi, provider_npi as provider_npi, practice_npi as practice_npi, master_profile,
           fk_practice_golden_address_id, fk_practice_crosswalk_address,
           practice_address_line1, practice_address_line2, practice_city, practice_state, practice_zip_code,
           tin as plbt_tin, tin as provider_tin,
        practice_tin as practice_tin, accepting_new_bhp_patients, '' as accreditation_body, '' as accreditation_status, area_of_expertise, billing_email_address, billing_fax, billing_phone, caqh, chp_provider, claim_remit_address_line1, claim_remit_address_line2, claim_remit_city, claim_remit_name, claim_remit_state, claim_remit_zip_code, clinical_staff_language_spoken1, clinical_staff_language_spoken2, clinical_staff_language_spoken3, cred_status, degree, dob, ecp_provider, employed, emr_type, emr_version, end_date, '' as facility_address_line1, '' as facility_address_line2, '' as facility_city, '' as facility_clia, '' as facility_county, '' as facility_fax, '' as facility_name_dba, '' as facility_state, '' as facility_telephone, '' as facility_type, '' as facility_zip_code, fee_schdule, '' as fee_schedule, filename, filepath, first_name, fk_claim_remit_crosswalk_address, fk_claim_remit_golden_address_id, fk_claim_remit_legacy_ulid, '' as fk_facility_crosswalk_address, '' as fk_facility_golden_address_id, '' as fk_facility_legacy_ulid, fk_mailing_crosswalk_address, fk_mailing_golden_address_id, fk_mailing_legacy_ulid, fk_practice_legacy_ulid, future_first_day_of_employment, future_last_day_of_employment, gender, hc, hide_in_directory, '' as hours_of_operation_friday_end_time, '' as hours_of_operation_friday_start_time, '' as hours_of_operation_monday_end_time, '' as hours_of_operation_monday_start_time, '' as hours_of_operation_saturday_end_time, '' as hours_of_operation_saturday_start_time, '' as hours_of_operation_sunday_end_time, '' as hours_of_operation_sunday_start_time, '' as hours_of_operation_thursday_end_time, '' as hours_of_operation_thursday_start_time, '' as hours_of_operation_tuesday_end_time, '' as hours_of_operation_tuesday_start_time, '' as hours_of_operation_wednesday_end_time, '' as hours_of_operation_wednesday_start_time, iops_data_factory_execution_message, iops_data_factory_execution_status, iops_data_factory_pipeline_run_id, iops_provider_credentialing_method, iops_request_create_datetime, iops_roster_format, iops_roster_type, iops_trading_partner_id, language_1, language_2, language_3, last_name, latest_data_rank, license, lineage_filename, mailing_address_city, mailing_address_line1, mailing_address_line2, mailing_address_state, mailing_address_zip_code, '' as main_webpage_url, medicaid, '' as medicaid_facility_number, medicare, '' as medicare_facility_number, middle_name, modtime, organization_name, practice_county, practice_fax, practice_manager_email_address, practice_name_dba, practice_telephone, practice_webpage_url, preferred_communication_method, provider_email_address, provider_type, row_in_file, '' as services_offered_text_or_url, specialty, ssn, start_date, time_folder FROM professional_merged UNION select '0' as entity_type_code, practice_npi as plbt_npi, '' as provider_npi, practice_npi as practice_npi, master_profile,
           fk_facility_golden_address_id as fk_practice_golden_address_id, fk_facility_crosswalk_address as fk_practice_crosswalk_address,
           facility_address_line1 as practice_address_line1, facility_address_line2 as practice_address_line2,
           facility_city as practice_city, facility_state as practice_state, facility_zip_code as practice_zip_code,
           tin as plbt_tin, '' as provider_tin, tin as practice_tin
        , '' as accepting_new_bhp_patients, accreditation_body, accreditation_status, '' as area_of_expertise, '' as billing_email_address, billing_fax, billing_phone, '' as caqh, '' as chp_provider, claim_remit_address_line1, claim_remit_address_line2, claim_remit_city, claim_remit_name, claim_remit_state, claim_remit_zip_code, clinical_staff_language_spoken1, clinical_staff_language_spoken2, clinical_staff_language_spoken3, '' as cred_status, '' as degree, '' as dob, ecp_provider, '' as employed, emr_type, emr_version, end_date, facility_address_line1, facility_address_line2, facility_city, facility_clia, facility_county, facility_fax, facility_name_dba, facility_state, facility_telephone, facility_type, facility_zip_code, '' as fee_schdule, fee_schedule, filename, filepath, '' as first_name, '' as fk_claim_remit_crosswalk_address, '' as fk_claim_remit_golden_address_id, '' as fk_claim_remit_legacy_ulid, fk_facility_crosswalk_address, fk_facility_golden_address_id, fk_facility_legacy_ulid, '' as fk_mailing_crosswalk_address, '' as fk_mailing_golden_address_id, '' as fk_mailing_legacy_ulid, '' as fk_practice_legacy_ulid, '' as future_first_day_of_employment, '' as future_last_day_of_employment, '' as gender, hc, hide_in_directory, hours_of_operation_friday_end_time, hours_of_operation_friday_start_time, hours_of_operation_monday_end_time, hours_of_operation_monday_start_time, hours_of_operation_saturday_end_time, hours_of_operation_saturday_start_time, hours_of_operation_sunday_end_time, hours_of_operation_sunday_start_time, hours_of_operation_thursday_end_time, hours_of_operation_thursday_start_time, hours_of_operation_tuesday_end_time, hours_of_operation_tuesday_start_time, hours_of_operation_wednesday_end_time, hours_of_operation_wednesday_start_time, iops_data_factory_execution_message, iops_data_factory_execution_status, iops_data_factory_pipeline_run_id, iops_provider_credentialing_method, iops_request_create_datetime, iops_roster_format, iops_roster_type, iops_trading_partner_id, '' as language_1, '' as language_2, '' as language_3, '' as last_name, latest_data_rank, '' as license, lineage_filename, mailing_address_city, mailing_address_line1, mailing_address_line2, mailing_address_state, mailing_address_zip_code, main_webpage_url, '' as medicaid, medicaid_facility_number, '' as medicare, medicare_facility_number, '' as middle_name, modtime, organization_name, '' as practice_county, '' as practice_fax, '' as practice_manager_email_address, '' as practice_name_dba, '' as practice_telephone, '' as practice_webpage_url, '' as preferred_communication_method, '' as provider_email_address, '' as provider_type, row_in_file, services_offered_text_or_url, '' as specialty, '' as ssn, start_date, time_folder FROM facility_merged
(Wed Sep 23 21:04:35 UTC 2020)- [/mnt/ods/bdp_2020_09_23_big_abtest_original_coalesced/plbt-.parquet] finished writing in (106) secs


*** PLBT
[plbt] 390943
